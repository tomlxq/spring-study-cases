# NAT虚拟机上网
## 服务器：两网卡的设置：
eth0:192.168.43.46 掩码：255.255.255.0 网关：192.168.43.1 #可以连接Internet相联
eth1:192.168.238.2 掩码：255.255.255.0 192.168.238.1 #与局域网相联
客户机：192.168.2.10/24 网关：192.168.238.2 #与eth1同一网段,网关为eht1
## 配置DNS
无线局域网适配器 无线网络连接:

   连接特定的 DNS 后缀 . . . . . . . :
   IPv6 地址 . . . . . . . . . . . . : 2409:8955:3414:
   临时 IPv6 地址. . . . . . . . . . : 2409:8955:3414:
   本地链接 IPv6 地址. . . . . . . . : fe80::3818:19c3
   IPv4 地址 . . . . . . . . . . . . : 192.168.43.46
   子网掩码  . . . . . . . . . . . . : 255.255.255.0
   默认网关. . . . . . . . . . . . . : fe80::c686:e9ff
                                       192.168.43.1

以太网适配器 VMware Network Adapter VMnet8:

   连接特定的 DNS 后缀 . . . . . . . :
   IPv4 地址 . . . . . . . . . . . . : 192.168.238.2
   子网掩码  . . . . . . . . . . . . : 255.255.255.0
   默认网关. . . . . . . . . . . . . : 192.168.238.1
## 配置虚拟机网络
Edit->Virtural network editor选VMnet8点NAT Settings
Network:vmnet8
Subnet IP:192.168.238.0
Subnet mask:255.255.255.0
Gateway:192.168.238.2

## 配置虚拟机ens33
配置网卡 `/etc/sysconfig/network-scripts/ifcfg-ens33 `
```
TYPE=Ethernet
PROXY_METHOD=none
BROWSER_ONLY=no
GATEWAY=192.168.238.2
IPADDR=192.168.238.105
NETMASK=255.255.255.0
BOOTPROTO=static
DEFROUTE=yes
IPV4_FAILURE_FATAL=no
IPV6INIT=YES
IPV6_AUTOCONF=yes
IPV6_DEFROUTE=yes
IPV6_FAILURE_FATAL=no
IPV6_ADDR_GEN_MODE=stable-privacy
NAME=ens33
UUID=d2cded00-62f7-47ae-9d8a-56e29a0533d7
DEVICE=ens33
ONBOOT=yes
DNS1=192.168.238.2
```
## 配置 /etc/resolv.conf
```
cat /etc/resolv.conf
# Generated by NetworkManager
nameserver 192.168.238.2
search localhost
```
## 配置 `/etc/hosts`
```
cat /etc/hosts
127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
::1         localhost localhost.localdomain localhost6 localhost6.localdomain6
192.168.238.150 localhost
```

## 重启网络
`service network restart`



## 常见问题

### Linux下解决网卡重启失败Restarting network (via systemctl): Job for network.service failed

重启网卡报错

`Restarting network (via systemctl):  Job for network.service failed because the control process exited with error code. See "systemctl status network.service" and "journalctl -xe" for details.`

解决：

```
systemctl stop NetworkManager
systemctl disable NetworkManager
service network restart
```




